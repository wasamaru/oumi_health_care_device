# MasterfootSensor基板 技術仕様解説書

## 1. 概要

本ドキュメントは、提供された回路図「Master回路図_20210528.pdf」および部品表「Master部品表_20210430.xls」に基づき、MasterfootSensor基板の回路構成、動作原理、および各コンポーネントの役割を詳細に解説するものです。

この基板は、太陽誘電製Bluetoothモジュール「EYSHCNZXZ」を主制御装置とし、複数のセンサー（最大4系統）を接続・制御するためのマスターボードとして設計されています。電源管理には昇降圧DC-DCコンバータ、プッシュボタン式電源コントローラ、ロードスイッチなどを採用し、効率的で安定した電力供給と低消費電力動作を実現しています。ユーザーインターフェースとして、複数のLEDとスイッチを備え、多様なアプリケーションへの応用が可能です。

## 2. 回路ブロック詳細

本基板は、主に以下の5つの機能ブロックから構成されています。

| ブロック名 | 機能概要 |
|:---|:---|
| 電源管理ブロック | 外部からの多様な電源入力を受け、安定化された内部電源を生成・制御します。 |
| 無線通信・マイコンブロック | Bluetooth Low Energyによる無線通信と、システム全体の制御を担います。 |
| センサー出力ブロック | 外部に接続された最大4系統のセンサーデバイスを駆動・制御します。 |
| ユーザーインターフェースブロック | プッシュボタンやDIPスイッチによるユーザー操作と、LEDによる状態表示を行います。 |
| 接続インターフェースブロック | 外部電源、センサー、デバッグ用の物理的な接続端子を提供します。 |

### 2.1. 電源管理ブロック

本基板の心臓部とも言える電源回路は、安定性と柔軟性を両立させるために、複数の専用ICを組み合わせた高度な構成となっています。

**主要コンポーネント:**

| 参照番号 | 部品名 | メーカー | 役割 |
|:---|:---|:---|:---|
| U3 | TPS630250RNCT | Texas Instruments | 昇降圧DC-DCコンバータ |
| U4 | LTC2955IDDB-1#TRMPBF | Analog Devices | プッシュボタンON/OFFコントローラ |
| U5 | TPS22919DCKT | Texas Instruments | ロードスイッチ |
| CN1 | 10118194-0001LF | Amphenol | microUSBコネクタ（電源入力） |
| CN4-CN7 | PJ1-023 | CUI Devices | DCジャック（電源入力） |

**動作解説:**

電源は、microUSBコネクタ(CN1)からの5V、または4つのDCジャック(CN4-CN7)から供給されます。これらの入力電源は、まずプッシュボタンコントローラ **U4 (LTC2955)** に接続されます。

ユーザーがプッシュボタン **S1 (SKHUBHE010)** を押すと、U4がそれを検知し、`EN`（Enable）ピンをアクティブにします。この信号により、昇降圧DC-DCコンバータ **U3 (TPS630250RNCT)** が起動します。U3は、2.3Vから5.5Vという広い入力電圧範囲に対応し、接続された電源の種類（USB、電池、ACアダプタなど）によらず、安定した3.3Vの主電源（`+3.3V`）を生成します。このICは最大95%の高い変換効率を誇り、インダクタL1、抵抗R11, R12、および複数のコンデンサと共に、高効率なバックブースト（昇降圧）回路を構成しています。

U4はまた、電源のON/OFFシーケンスを管理するだけでなく、`TMR`ピンに接続されたコンデンサ **C11 (330nF)** によって、ボタン長押しによる強制シャットダウン時間を約1.8秒に設定しています。これは、回路図に記載されている計算式 `(0.33uF / 0.19uA) * 64ms ≒ 1.8sec` からも確認できます。さらに、`KILL`ピンの電圧を監視し、システムの異常時に自動でパワーオフする保護機能も備えています。

生成された3.3V電源は、ロードスイッチ **U5 (TPS22919DCKT)** にも供給されます。U5は、マイコンからの制御信号（`P0.08`）によって、特定の回路ブロック（この回路図では`VDD_MID`）への電力供給をON/OFFする役割を担います。これにより、使用しない回路ブロックへの電力供給を遮断し、システム全体の消費電力をきめ細かく管理することが可能になります。

### 2.2. 無線通信・マイコンブロック

システムの頭脳として、無線通信機能と演算処理機能を統合したBluetoothモジュールが採用されています。

**主要コンポーネント:**

| 参照番号 | 部品名 | メーカー | 役割 |
|:---|:---|:---|:---|
| U1 | EYSHCNZXZ | 太陽誘電 | Bluetooth Low Energyモジュール |
| L2, L3 | BLM18AG102SN1D | 村田製作所 | フェライトビーズ（ノイズ対策） |

**動作解説:**

**U1 (EYSHCNZXZ)** は、Nordic Semiconductor社の高性能SoC (System on a Chip) 「nRF52832」を内蔵したBluetoothモジュールです。この単一のモジュールが、32-bit ARM Cortex-M4Fプロセッサとしての役割と、Bluetooth 4.2 (BLE) 無線通信機能を同時に提供します。これにより、基板全体の制御、センサーデータの処理、外部デバイス（スマートフォンなど）との無線通信を一手に担います。

モジュールの`VCC_NRF`ピンには、フェライトビーズ **L2** を介して3.3V電源が供給されます。L2は、電源ラインから混入する高周波ノイズを除去し、無線性能の安定化に寄与します。同様に、`VDD_MID`から電源供給される回路ブロックへも、フェライトビーズ **L3** が挿入されており、電源ラインのノイズ対策が徹底されています。

U1は、豊富なGPIO（汎用入出力）ポートを備えており、これらを用いて後述するセンサー出力ブロックやユーザーインターフェースブロックを直接制御します。例えば、`P0.28`から`P0.31`はアナログ入力(AIN)としても機能し、センサーからのアナログ信号を読み取ることが可能です。また、`SWDIO`/`SWDCLK`ピンはデバッグ・プログラミング用のシリアルワイヤデバッグ(SWD)インターフェースであり、コネクタ **CN3** を介して外部のデバッガと接続されます。

### 2.3. センサー出力ブロック

本基板の主要な機能の一つである、外部センサーの駆動・制御を行うブロックです。

**主要コンポーネント:**

| 参照番号 | 部品名 | メーカー | 役割 |
|:---|:---|:---|:---|
| Q1-Q4 | FDV305N | ON Semiconductor | NチャネルMOSFET |
| D7-D10 | 1N4148WX-TP | Micro Commercial Co | スイッチングダイオード |
| CN4-CN7 | PJ1-023 | CUI Devices | センサー接続用コネクタ |

**動作解説:**

DCジャックとしても利用されるコネクタ **CN4からCN7** は、センサーデバイスを接続するための出力ポートとしても機能します。各コネクタには、`VDD_MID`電源ラインが接続されており、NチャネルMOSFET **Q1からQ4** を介してGNDにスイッチングされます。

マイコン(U1)のGPIOポート（`P0.06`, `P0.07`, `P0.04`, `P0.02`）から制御信号が各MOSFETのゲートに入力されます。信号がHighになるとMOSFETがONし、コネクタの対応するピンがGNDに接続され、センサー回路に電流が流れる、あるいは信号がLowになる、といった制御が行われます。これにより、最大4系統のセンサーを個別にON/OFF制御することが可能です。

各MOSFETと並列に接続されているダイオード **D7からD10** は、フライホイールダイオードとして機能します。センサーとしてリレーやソレノイドなどの誘導性負荷を接続した場合、スイッチをOFFにした際に発生する逆起電力からMOSFETを保護する重要な役割を果たします。

### 2.4. ユーザーインターフェースブロック

ユーザーが基板を操作し、その状態を視覚的に確認するためのインターフェースです。

**主要コンポーネント:**

| 参照番号 | 部品名 | メーカー | 役割 |
|:---|:---|:---|:---|
| S1 | SKHUBHE010 | アルプスアルパイン | プッシュボタン（電源ON/OFF） |
| S2 | CHS-06A | コパル電子 | 6ポジションDIPスイッチ |
| S3 | SKSGACE010 | アルプスアルパイン | プッシュボタン（キャリブレーション用） |
| D1,D2,D3 | SMLP13/SML-P12/SML-P11 | Rohm | ステータスLED（青・橙・緑） |
| D11 | APDA3020LZGCK | Kingbright | 電源LED（緑） |

**動作解説:**

- **S1**: 電源コントローラU4に接続され、システムの電源ON/OFFをトリガーします。
- **S3**: マイコンU1の`P0.11`に接続されており、「キャリブレーションスイッチ」と記載があることから、ソフトウェアで特定の機能（例：センサーのゼロ点調整）を実行するために使用されると推測されます。
- **S2**: 6つの独立したスイッチを持つDIPスイッチで、各スイッチがマイコンU1の異なるGPIOピン（`P0.12`, `P0.14`など）に接続されています。これにより、基板の動作モードや設定を物理的に切り替えることができます。
- **LED群**: 電源状態を示す **D11 (POWER_LED)** は、U4の電源監視機能と連動して点灯します。その他のLED **D1, D2, D3** は、マイコンのGPIOに接続されており、Bluetoothの接続状態、エラー通知、動作モードなど、様々なステータスをソフトウェア制御で表示するために使用されると考えられます。

## 3. 結論

MasterfootSensor基板は、Nordic nRF52832 SoCを搭載した太陽誘電製モジュールを中心に、高度な電源管理ICと柔軟な入出力インターフェースを組み合わせた、完成度の高いIoTデバイス用マスターボードです。

特に、昇降圧対応のDC-DCコンバータとプッシュボタンコントローラによる洗練された電源システムは、バッテリー駆動を含む多様なユースケースに対応可能であり、ロードスイッチによる省電力設計も考慮されています。4系統のMOSFET出力は、複数のセンサーやアクチュエータを制御するアプリケーションに最適です。

本解析ドキュメントが、この基板の理解と、さらなる開発・応用のための技術的な一助となれば幸いです。

---
*このドキュメントは、提供された回路図と部品表に基づき、Manus AIによって自動生成されました。部品の仕様や回路の動作に関する解釈には、設計者の意図と異なる部分が含まれる可能性があります。*
