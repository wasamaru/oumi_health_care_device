# 技術リサーチ項目（1128変更対応）

**作成日**: 2025年12月18日
**更新日**: 2025年12月18日（メール追加要望反映）
**目的**: 見積もり更新に向けた技術調査項目の整理

---

## 1. Type-C磁石式ケーブル調査

### 1.1 製品仕様要件

| 項目 | 要件 |
|------|------|
| コネクタ形状 | USB Type-C（基板側） |
| 分離方式 | ポゴピン + 磁石分離 |
| **ケーブル長** | **10cm** |
| 電源供給 | 5V / 2A以上（USB Type-C標準） |
| データ通信 | USB 2.0（D+/D-） |
| 耐久性 | 5,000回以上の着脱 |
| 防滴性 | IPX4相当推奨 |

### 1.2 見積もりパターン（2種類必須）

| パターン | 接続先端子 | 基板側端子 | ケーブル長 | 用途 |
|---------|-----------|-----------|-----------|------|
| **A** | USB Type-A オス | マグネットType-C | 10cm | USB-Aポート付きモバイルバッテリー |
| **B** | USB Type-C オス | マグネットType-C | 10cm | Type-C出力モバイルバッテリー |

### 1.3 調査対象製品カテゴリ

#### A. マグネット式充電ケーブル（汎用品）
- Amazon/Aliexpress等で販売されている汎用マグネット式Type-Cケーブル
- 長所: 低コスト、即入手可能
- 短所: 品質バラつき、長期供給保証なし、10cm短尺の在庫少

#### B. 産業用マグネットコネクタ
- Pogo Pin専門メーカー（Mill-Max、Preci-Dip等）
- 長所: 高品質、長期供給保証
- 短所: 高コスト、MOQ大

#### C. OEM/カスタム品
- 中国メーカーでのカスタム製造
- 長所: 仕様調整可能（10cm短尺対応）、コスト中程度
- 短所: 開発期間、品質管理必要

### 1.4 主要サプライヤー候補

| サプライヤー | 製品タイプ | 参考価格(USD) | MOQ | 10cm対応 |
|-------------|-----------|--------------|-----|----------|
| NetDot（Amazon） | 汎用マグネットケーブル | $10-15 | 1 | △（要確認） |
| TOPK | 汎用マグネットケーブル | $8-12 | 1 | △（要確認） |
| Mill-Max | 産業用Pogo Pin | $5-20（コネクタのみ） | 100 | ○ |
| Shenzhen Various | OEM製造 | $3-8 | 500-1000 | ○ |

### 1.5 技術確認項目

- [ ] アスティナ社で使用実績のある製品の詳細仕様確認
- [ ] **10cmケーブル長での製品在庫確認**
- [ ] **Type-A/Type-C両パターンの製品在庫確認**
- [ ] 基板側Type-Cコネクタとの互換性確認
- [ ] ピンアサイン（VBUS/GND/D+/D-/CC）の確認
- [ ] 磁石強度と脱落防止性能
- [ ] EMC/ESD特性

### 1.6 コスト・入手性調査結果（確定）

#### マグネットタイプケーブル

| パターン | 単価(円) | 最短ケーブル長 | 備考 |
|---------|---------|--------------|------|
| Type-C → マグネットType-C | **¥1,500** | **1m** | 10cm品は流通なし |
| Type-A → マグネットType-C | **¥1,500** | **1m** | 10cm品は流通なし |

#### 通常ケーブル（マグネットなし）

| パターン | 単価目安(円) | ケーブル長 | 備考 |
|---------|-------------|-----------|------|
| Type-A → Type-C（通常品） | 700 | **10cm可** | 短尺は通常品のみ流通 |

#### 重要な制約事項

> **マグネットタイプは最短1m、10cmは一般的なType-A→Type-Cのみ流通**
>
> - マグネット式ケーブルで10cm品は市場に存在しない
> - 10cmの短尺が必須の場合、マグネットなしの通常Type-A→Type-Cケーブルのみ選択肢となる
> - **顧客へケーブル長1mで問題ないか確認が必要**

#### 見積もりパターン整理

| オプション | ケーブル仕様 | 単価(円) | 備考 |
|-----------|------------|---------|------|
| A | マグネットType-C to C（1m） | 1,500 | 推奨 |
| B | マグネットType-A to C（1m） | 1,500 | 推奨 |
| C | 通常Type-A to C（10cm） | 700 | マグネットなし |

---

## 2. EEPROM選定調査

### 2.1 設定データ要件分析

#### 保存対象データ（推定）

| データ項目 | サイズ(Byte) | 備考 |
|-----------|-------------|------|
| モード設定 | 1 | 4モード（2bit） |
| ボリューム設定 | 1 | 0-100%スケール |
| ピッチ設定 | 1 | 5段階 |
| 出力ch設定 | 4 | 各chのモーター/スピーカー設定 |
| キャリブレーション値 | 8 | 各chの調整値 |
| システムフラグ | 2 | 起動回数、エラーカウント等 |
| CRC/チェックサム | 2 | データ整合性 |
| 予備領域 | 13 | 将来拡張用 |
| **合計** | **32** | 1ページ程度 |

#### 必要容量
- 最小: 256 Byte（2Kbit）
- 推奨: 4-8 KByte（32-64Kbit）※複数世代保存、エラー回復用
- 余裕を見て: 32 KByte（256Kbit）

### 2.2 EEPROM候補部品比較

| 品番 | メーカー | 容量 | IF | 書換回数 | 動作温度 | 単価(円) |
|------|---------|------|-----|---------|---------|---------|
| AT24C256C-SSHL-T | Microchip | 256Kbit | I2C | 1M | -40〜+85℃ | 50-80 |
| M24C64-RMN6TP | ST | 64Kbit | I2C | 4M | -40〜+85℃ | 30-50 |
| M24C32-RMN6TP | ST | 32Kbit | I2C | 4M | -40〜+85℃ | 25-40 |
| 24LC256-I/SN | Microchip | 256Kbit | I2C | 1M | -40〜+85℃ | 60-90 |
| CAT24C256WI-GT3 | ON Semi | 256Kbit | I2C | 1M | -40〜+105℃ | 40-60 |

### 2.3 推奨部品

**第一候補: M24C64-RMN6TP（STMicroelectronics）**

| 項目 | 仕様 |
|------|------|
| 容量 | 64Kbit (8KB) |
| インターフェース | I2C（最大1MHz） |
| 書き換え回数 | 4,000,000回 |
| データ保持 | 200年（25℃） |
| 動作電圧 | 1.8V〜5.5V |
| 動作温度 | -40℃〜+85℃ |
| パッケージ | SO8N |
| 単価 | 約30-50円 |

**選定理由**:
- 4M回書き換えで十分な耐久性
- 広い電圧範囲（3.3V/5V両対応）
- 低コスト
- ST社の安定供給

### 2.4 回路設計要件（ESP32-S3対応）

#### I2C接続回路

```
ESP32-S3                     EEPROM
 │                             │
 ├──SDA──[4.7kΩ]──VDD          ├──SDA
 │                             │
 ├──SCL──[4.7kΩ]──VDD          ├──SCL
 │                             │
 │                             ├──A0,A1,A2──GND（アドレス0x50）
 │                             │
 └──GPIO(WP)──[10kΩ]──VDD      ├──WP（書込保護）
                               │
                               ├──VCC──[0.1uF]──GND
                               │
                               └──VSS──GND
```

#### ピンアサイン（ESP32-S3 / MBN52832）

| 信号 | ESP32-S3推奨 | MBN52832推奨 | 備考 |
|------|-------------|-------------|------|
| SDA | GPIO8 | P0.26 | I2C0標準ピン |
| SCL | GPIO9 | P0.27 | I2C0標準ピン |
| WP | GPIO10（任意） | P0.03（任意） | 書込保護制御 |

### 2.5 ファームウェア実装要点

- データ保存時はCRC/チェックサム付与
- 2重化書き込み（プライマリ/バックアップ領域）
- 書き込み失敗時のリトライ処理
- ウェアレベリング考慮（書き込み位置の分散）

---

## 3. ESP32-S3モジュール選定調査

### 3.1 モジュール候補比較

| モジュール名 | Flash | PSRAM | サイズ(mm) | 参考価格(円) | 備考 |
|-------------|-------|-------|-----------|-------------|------|
| ESP32-S3-WROOM-1-N8 | 8MB | なし | 18×25.5×3.1 | **850** | **採用候補** |
| ESP32-S3-WROOM-1-N16 | 16MB | なし | 18×25.5×3.1 | 700-900 | Flash増量 |
| ESP32-S3-WROOM-1-N8R2 | 8MB | 2MB | 18×25.5×3.1 | 700-900 | PSRAM付 |
| ESP32-S3-WROOM-1-N16R8 | 16MB | 8MB | 18×25.5×3.1 | 900-1,200 | 最大構成 |
| ESP32-S3-MINI-1-N8 | 8MB | なし | 15.4×20.5×2.4 | 500-700 | **小型版** |

### 3.2 推奨モジュール

**第一候補: ESP32-S3-WROOM-1-N8**

| 項目 | 仕様 |
|------|------|
| SoC | ESP32-S3 |
| コア | Xtensa LX7 デュアル @240MHz |
| Flash | 8MB |
| SRAM | 512KB |
| USB | USB OTG内蔵 |
| Bluetooth | 5.0 (LE) |
| Wi-Fi | 802.11 b/g/n |
| GPIO | 45本 |
| サイズ | 18×25.5×3.1mm |
| 動作温度 | -40〜+85℃ |

**選定理由**:
- 本プロジェクトの要件に十分な性能
- PSRAMは不要（音声処理等の大容量メモリ不要）
- コストパフォーマンス良好
- 技適取得済み

### 3.3 ESP32からESP32-S3への移行ポイント

| 項目 | ESP32 | ESP32-S3 | 移行影響 |
|------|-------|----------|---------|
| 開発環境 | ESP-IDF | ESP-IDF | 同一（バージョン確認） |
| Bluetooth | Classic + BLE 4.2 | BLE 5.0のみ | ★要確認（Classic使用有無） |
| GPIO割り当て | GPIO0-39 | GPIO0-48 | ピン再割り当て必要 |
| USB | 外部IC必要 | 内蔵 | 簡略化 |
| I2S | あり | あり（改良版） | 互換性あり |
| SPI | あり | あり | 互換性あり |

### 3.4 技術確認項目

- [ ] **Bluetooth Classic使用有無の確認**（ESP32-S3はBLE 5.0のみ）
- [ ] 現行ファームウェアのGPIO使用状況確認
- [ ] I2S音声出力の互換性確認
- [ ] 開発環境（ESP-IDF）バージョン確認
- [ ] 技適認証の確認

---

## 4. 出力チャンネル仕様（確定）

### 4.1 確定仕様

| チャンネル | 機能 | 自動認識 | 備考 |
|-----------|------|---------|------|
| CH1 | スピーカー/モーター | **あり** | ID抵抗方式（SBU活用） |
| CH2 | スピーカー/モーター | **あり** | ID抵抗方式（SBU活用） |
| CH3 | スピーカー固定 | なし | - |
| CH4 | スピーカー固定 | なし | - |

### 4.2 スーパーキャパシタ調査（不要に）

**結論**: 4ch全自動切り替えは行わないため、スーパーキャパシタ調査は**不要**。

（参考情報として記録）
- 4ch全自動切り替え時に必要だったサイズ: 面2cm×厚み5mm×2台
- 筐体薄型化要件との両立が困難なため、2ch自動切替で確定

---

## 5. DVT/PVT見積もり調整用資料

### 5.1 既存見積もり構成（参考）

| フェーズ | メカ | 回路設計 | 基板設計 | FW開発 | 金型 |
|---------|------|---------|---------|--------|------|
| PoC | ○ | ○ | ○ | ○ | - |
| EVT | ○ | ○ | ○ | ○ | - |
| DVT | ○ | ○ | ○ | ○ | ○ |
| PVT | ○ | ○ | ○ | ○ | ○ |

### 5.2 メカなし・金型なし見積もりパターン

| フェーズ | メカ | 回路設計 | 基板設計 | FW開発 | 金型 | 備考 |
|---------|------|---------|---------|--------|------|------|
| DVT | **×** | ○ | ○ | ○ | **×** | 成形は顧客側 |
| PVT | **×** | ○ | ○ | ○ | **×** | 成形は顧客側 |

### 5.3 追加検討費用（成形切り分け時）

| 項目 | 発生条件 | 概算 |
|------|---------|------|
| 仕様調整打合せ | 顧客側で外形等を明確化できない場合 | 工数×時間単価 |
| 設計レビュー | 成形側からの設計確認依頼 | 1-2回/フェーズ |
| インターフェース文書化 | 基板-成形間の要求仕様書 | 初回のみ |

---

## 6. 調査スケジュール

| 項目 | 優先度 | 担当 | 期限 | ステータス |
|------|--------|------|------|----------|
| 磁石式ケーブル費用確認（10cm） | **高** | アスティナ | 次回打合せ前 | 未着手 |
| **Type-A/Type-C両パターン調査** | **高** | アスティナ | 次回打合せ前 | 未着手 |
| EEPROM部品選定 | **高** | アスティナ | 次回見積もり時 | 未着手 |
| **ESP32-S3モジュール選定** | **高** | アスティナ | 次回見積もり時 | 未着手 |
| DVT/PVTメカなし見積もり | **高** | アスティナ | 近日中 | 未着手 |
| ~~スーパーキャパシタ調査~~ | ~~中~~ | - | - | **不要（確定）** |

---

## 7. 参考情報

### 7.1 部品入手性確認先

| 部品カテゴリ | 調達先候補 |
|-------------|-----------|
| マグネットケーブル | Amazon、Aliexpress、専門商社 |
| EEPROM | DigiKey、Mouser、秋月電子 |
| ESP32-S3 | DigiKey、Mouser、秋月電子、Switch Science |

### 7.2 参照ドキュメント

- 既存見積書（ESP32版）: `見積書（Espressif ESP32-WROOM-32E版）.md`
- 既存見積書（村田版）: `見積書（村田製作所 MBN52832版）.md`
- アップグレード計画: `アップグレード計画_整理（メカ・ファーム・回路／流用・改修ブロック）.md`
- 1128議事録: `1128_minutes.md`
- 変更点整理: `1128_変更点整理_見積もり更新用.md`

### 7.3 ESP32-S3関連リソース

- [Espressif ESP32-S3 Datasheet](https://www.espressif.com/sites/default/files/documentation/esp32-s3_datasheet_en.pdf)
- [ESP32-S3-WROOM-1 Datasheet](https://www.espressif.com/sites/default/files/documentation/esp32-s3-wroom-1_wroom-1u_datasheet_en.pdf)
- [ESP-IDF Programming Guide](https://docs.espressif.com/projects/esp-idf/en/latest/esp32s3/)
